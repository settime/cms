if(!window.LChart){throw new Error("未能加载loongchart.core.js，该js必须在其他LChart框架的js加载之前被引用。\n"+"Not loaded loongchart.core.js which must be loaded before other LChart's js.")}else{LChart.Const.Skins.BlackAndWhite.RangeHistogram={SmallLabelColor:null,BigLabelColor:null}}LChart.RangeHistogram=LChart.getCore().__extends({GraphType:"RangeHistogram"});LChart.RangeHistogram._spreadSkin=function(b,a){b.smallLabel={};b.smallLabel.color=a.SmallLabelColor||null;b.bigLabel={};b.bigLabel.color=a.BigLabelColor||null};LChart.RangeHistogram._getDefaultOptions=function(b){var a=LChart.Methods.Extend(b,{animateY:true,animateX:true,histogram:{colors:null,length:null,gap:null,useSameColor:true},tip:{content:function(c){var d=null;if(this.valueType=="d"){d="<br/>Small Value: "+c.value[0].format("yyyy-MM-dd")+"<br/>Big Value: "+c.value[1].format("yyyy-MM-dd")}else{if(this.valueType=="t"){d="<br/>Small Value: "+c.value[0].format("MM-dd hh:mm")+"<br/>Big Value: "+c.value[1].format("MM-dd hh:mm")}else{if(this.valueType=="m"){d="<br/>Small Value: "+c.value[0].format("hh:mm:ss.S")+"<br/>Big Value: "+c.value[1].format("hh:mm:ss.S")}else{d="<br/>Small Value: "+c.value[0]+"<br/>Big Value: "+c.value[1]}}}return"<div>"+c.text+"："+d+"&nbsp;</div>"}},smallLabel:{show:true,content:function(c){if(this.valueType=="d"){return c.format("yyyy-MM-dd")}else{if(this.valueType=="t"){return c.format("MM-dd hh:mm")}else{if(this.valueType=="m"){return c.format("hh:mm:ss.S")}else{return c.toString()}}}},color:null,fontweight:null,fontsize:null,fontfamily:null},bigLabel:{show:true,content:function(c){if(this.valueType=="d"){return c.format("yyyy-MM-dd")}else{if(this.valueType=="t"){return c.format("MM-dd hh:mm")}else{if(this.valueType=="m"){return c.format("hh:mm:ss.S")}else{return c.toString()}}}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return a};LChart.RangeHistogram._getCheckOptions=function(){return{__top:[["animateY","b"],["animateX","b"]],histogram:[["colors","ca"],["length","n"],["gap","n"],["useSameColor","b"]],smallLabel:[["show","b"],["content","f"],["color","c"],["fontweight","s"],["fontsize","n"],["fontfamily","s"]],bigLabel:[["show","b"],["content","f"],["color","c"],["fontweight","s"],["fontsize","n"],["fontfamily","s"]]}};LChart.RangeHistogram._drawgraphic=function(s,h,n,d){if(d.valueType=="p"){throw new Error(s._messages.WrongParam+s._messages.ValueTypeMustNotBePercent)}if(h==s.ID){s._configs.valueAxiaDataIsRange=true}var f=s._formatAxisData();var a=s._calculateOutersValid();var r=s._computeAxis(a);var q=s._getDrawableCoordinate();s.shapes[h]={histograms:[]};if(!s.coordinates.histograms){s.coordinates.histograms={}}s.coordinates.histograms[h]=[];var u=s._configs.specificConfig[h];var b=d.shadow.show&&d.shadow.blur>0;var g=d.shadow.show?d.shadow:null;var e=d.histogram.length;var l=d.histogram.gap;if(f.multiple){if(l&&l>0){var t=(r.labelDistance-f.demanCount*2)/(f.demanCount+1);l=Math.min(l,t)}else{l=r.labelDistance/20}}else{l=0}var e=d.histogram.length;if(e&&e>0){var c=f.multiple?((r.labelDistance-(f.demanCount+1)*l)/f.demanCount):r.labelDistance*0.8;e=Math.min(e,c)}else{e=(r.labelDistance-(f.demanCount+1)*l)/(f.multiple?(f.demanCount+0.5):1.5)}var i=(d.histogram.colors&&d.histogram.colors.length>0?d.histogram.colors:null)||LChart.Const.Defaults.FillColors;if(h==s.ID){s.coordinates.draw=q;s._configs.legendColors=i}var p=function(x,H,v,L,C,E,B){s.DrawFigures.createRectangleFill(x,H,v,L,C,B||g);if(E){var K=E.value[0];var A=E.value[1];if(K>A){K=E.value[1];A=E.value[0]}var w=d.smallLabel;if(w.show){var I=typeof w.content=="function"?w.content.call(d,K):"";if(I){var F=E.smallfontsize||w.fontsize||LChart.Methods.CapValue(L,18,11);var G=E.smallfontweight||w.fontweight;var J=E.smallfontcolor||w.color;var D=x+v/2;var z=H+L+F*1.15;s.DrawFigures.createText(I,D,z,"center",G,F,w.fontfamily,J)}}w=d.bigLabel;if(w.show){var y=typeof w.content=="function"?w.content.call(d,A):"";if(y){var F=E.bigfontsize||w.fontsize||LChart.Methods.CapValue(L,18,11);var G=E.bigfontweight||w.fontweight;var J=E.bigfontcolor||w.color;var D=x+v/2;var z=H-F/3;s.DrawFigures.createText(y,D,z,"center",G,F,w.fontfamily,J)}}}};var k=function(y,x,C,B,z,v,w,A){this.indexX=y;this.indexY=x;this.left=C;this.top=B;this.width=z;this.height=v;this.data=A;this.isHovered=false;this.color=w;this.redraw=function(D,E){if(arguments.length==1&&typeof arguments[0]=="boolean"){E=arguments[0];D=undefined}var F=g;if(b&&D){F=LChart.Methods.DeepCopy(g);F.color=D}p(this.left,this.top,this.width,this.height,D||this.color,E?this.data:null,F)};this.click=function(E){var D=typeof this.data.click=="function"?this.data.click:(d.click||null);if(D){D(this.data,E)}};if(d.tip.show&&typeof d.tip.content=="function"){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display="inline"}else{var F=this.left+this.width/2+5;var E=this.top+this.height/2;this.tip=s._createTip(d.tip.content.call(d,this.data),F,E);if(F+this.tip.clientWidth>r.maxX){s._changeTip(this.tip,F-this.tip.clientWidth)}var D=this;
D.tip.onclick=function(G){D.click(G)}}};this.hideTip=function(){if(this.tip){this.tip.style.display="none"}}}};var m=function(v,C){var F=function(M){var L=(d.animateY?v:1)*(r.maxY-r.minY)*s._getFormatDiff(f.vValueType,f.vMinValue,M)/s._getFormatDiff(f.vValueType,f.vMinValue,f.vMaxValue);return L};var x=function(N,M,O){var L=(O&&d.animateY?v:1)*(r.maxY-r.minY)*s._getFormatDiff(f.vValueType,N,M)/s._getFormatDiff(f.vValueType,f.vMinValue,f.vMaxValue);return L};for(var E=0,K;K=n[E];E++){var w=(d.animateX?v:1)*e;if(f.multiple){var B=K.color||i[E%i.length];for(var A=0;A<K.value.length;A++){var y=K.value[A];if(y[0]!=null&&y[1]!=null){var I=f.demanCount/2-E;var z=r.startPos+r.labelDistance*A-I*e-(I-0.5)*l;var J=F(y);var H=r.maxY-J;var J=x(y[0],y[1],true);var H=r.maxY-J-x(f.vMinValue,Math.min(y[0],y[1]));if(C>=1){var D={value:y,label:f.lLabels[A],click:K.click,mouseover:K.mouseover,mouseleave:K.mouseleave,text:K.text,indexX:A,indexY:E,bigfontcolor:K.bigfontcolor,bigfontsize:K.bigfontsize,bigfontweight:K.bigfontweight,smallfontcolor:K.smallfontcolor,smallfontsize:K.smallfontsize,smallfontweight:K.smallfontweight};var G=new k(A,E,z,H,w,J,B,D);s.shapes[h].histograms.push(G);p(z,H,w,J,B,D);if(!s.coordinates.histograms[h][A]){s.coordinates.histograms[h][A]=[]}s.coordinates.histograms[h][A][E]={left:z,top:H,width:w,height:J,color:B}}else{p(z,H,w,J,B)}}}}else{var y=K.value;if(y[0]!=null&&y[1]!=null){var z=r.startPos+r.labelDistance*E-e/2;var J=x(y[0],y[1],true);var H=r.maxY-J-x(f.vMinValue,Math.min(y[0],y[1]));var B=K.color||(d.histogram.useSameColor?"rgba(69,114,167,1)":i[E%i.length]);if(C>=1){K.indexX=E;K.indexY=null;var G=new k(E,null,z,H,w,J,B,K);s.shapes[h].histograms.push(G);p(z,H,w,J,B,K);s.coordinates.histograms[h][E]={left:z,top:H,width:w,height:J,color:B}}else{p(z,H,w,J,B)}}}}};var j=function(){var x=function(z,D){var C=null;for(var B=0,A;A=s.shapes[h].histograms[B];B++){if(A.left<=z&&A.left+A.width>=z&&A.top<=D&&A.top+A.height>=D){C=A;break}}return C};var w=function(A){var A=window.event||A;var y=s._getMouseLoction(A);var z=x(y.X,y.Y);if(z){z.click(A)}};var v=function(F){var F=window.event||F;var A=s._getMouseLoction(F);var E=x(A.X,A.Y);if(E){s._configs.cursorPointer=true}if(u.currentMouseShape!=E){var B=u.currentMouseShape;if(B){var y=typeof B.data.mouseleave=="function"?B.data.mouseleave:(d.mouseleave||null);if(y){y(B.data,F)}}if(b||u.currentMouseShape){s.redrawAll()}u.currentMouseShape=E;for(var D=0,B;B=s.shapes[h].histograms[D];D++){if(B!=E&&B.isHovered){B.isHovered=false;if(B.hideTip){B.hideTip()}}}if(E){E.isHovered=true;var C=d.mouseoverTransparency;E.redraw("rgba(255,255,255,"+(C>0&&C<1?C:0.2)+")");if(E.showTip){E.showTip()}var z=typeof E.data.mouseover=="function"?E.data.mouseover:(d.mouseover||null);if(z){z(E.data,F)}}}};s._addEventListener("click",w);s._addEventListener("mousemove",v)};var o=function(){for(var w=0,v;v=s.shapes[h].histograms[w];w++){v.redraw(true)}};return{drawSegments:m,mouseEvents:j,redraw:o}};