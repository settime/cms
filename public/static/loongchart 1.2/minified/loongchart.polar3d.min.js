if(!window.LChart){throw new Error("未能加载loongchart.core.js，该js必须在其他LChart框架的js加载之前被引用。\n"+"Not loaded loongchart.core.js which must be loaded before other LChart's js.")}else{LChart.Const.Skins.BlackAndWhite.Polar3D={SeparateLineColor:null,OuterLabelColor:null,OuterLabelBorderColor:null,OuterLabelBackColor:"rgba(255,255,255,0.3)",StaffFontColor:null,StaffBackColor:null,ScaleLineColors:null}}LChart.Polar3D=LChart.getCore().__extends({GraphType:"Polar3D"});LChart.Polar3D._spreadSkin=function(b,a){b.separateLine={};b.outerLabel={};b.staff={};b.scale={};b.separateLine.color=a.SeparateLineColor||null;b.outerLabel.color=a.OuterLabelColor||null;b.outerLabel.backcolor=a.OuterLabelBackColor||null;b.outerLabel.bordercolor=a.OuterLabelBorderColor||null;b.staff.fontcolor=a.StaffFontColor||null;b.staff.backcolor=a.StaffBackColor||null;b.scale.linecolors=a.ScaleLineColors||null};LChart.Polar3D._getDefaultOptions=function(b){var a=LChart.Methods.Extend(b,{offX:0,offY:0,radius:null,margin:null,colors:null,animateRotate:true,animateScale:true,scaleOverlay:true,startAngle:null,averageAngle:false,reflection3d:{reflectoffX:null,reflectoffY:null,zoomX:null,zoomY:null},separateLine:{show:false,color:null,width:null},scale:{linewidth:0.5,minvalue:null,maxvalue:null,interval:null,linecolors:null},staff:{show:true,content:function(c){return c.toString()},fontcolor:null,fontfamily:null,fontsize:null,fontweight:null,directions:["n","s","e","w"],backcolor:"rgba(255,255,255,0.3)"},outerLabel:{show:true,content:function(c){return c.text+" "+c.percent.toFixed(1)+"%"},withlegend:true,legendtype:null,length:null,color:null,backcolor:"rgba(220,220,220,0.2)",bordercolor:null,borderwidth:0.5,fontsize:null,fontfamily:null}});return a};LChart.Polar3D._getCheckOptions=function(){return{__top:[["offX","n"],["offY","n"],["radius","n"],["margin","n"],["colors","ca"],["animateRotate","b"],["animateScale","b"],["startAngle","n"],["averageAngle","b"]],reflection3d:[["reflectoffX","n"],["reflectoffY","n"],["zoomX","n"],["zoomY","n"]],separateLine:[["show","b"],["color","c"],["width","n"]],scale:[["minvalue","n"],["maxvalue","n"],["interval","n"],["linecolors","ca"]],staff:[["show","b"],["content","f"],["fontcolor","c"],["fontfamily","s"],["fontsize","n"],["fontweight","s"],["directions","sa"],["backcolor","c"]],outerLabel:[["show","b"],["content","f"],["withlegend","b"],["legendtype","s"],["length","n"],["color","c"],["backcolor","c"],["bordercolor","c"],["borderwidth","n"],["fontsize","n"],["fontfamily","s"]]}};LChart.Polar3D._drawgraphic=function(G,n,z,h){var r=G._computeSegmentTotal(z);var f=z.length;var e=3;var d=3;var q=h.reflection3d.zoomX||1.2;var o=h.reflection3d.zoomY||0.9;if(G._configs._isIE678.isIE678){q=1;o=1}var E=G._computeRadiusForPies(h,q,o);if(G._configs._isIE678.isIE678){E.maxRadius*=0.9}var p=(h.colors&&h.colors.length>0?h.colors:null)||LChart.Const.Defaults.FillColors;var l=n==G.ID;if(l){G.coordinates.draw=E.coordinate;G._configs.legendColors=p}var j=G._getComputed(0,"n",h.scale,r.minval,r.maxval,8);var b=!h.radius||!LChart.Methods.IsNumber(h.radius)?E.maxRadius:h.radius;if(!G.coordinates.polar){G.coordinates.polar={}}G.coordinates.polar[n]={radius:b,centerX:E.centerX,centerY:E.centerY,outerlabels:[],staff:[],cemicircles:[]};G.shapes[n]={cemicircles:[],outerLabels:[],faces:null};var w=G.shapes[n];var v=h.reflection3d.reflectoffX||0;var t=h.reflection3d.reflectoffY||b/6;var C=h.separateLine.show?(h.separateLine.width||1):0;var D=h.separateLine.color||"#ffffff";var I=Math.PI*(h.startAngle==null?-0.5:h.startAngle);var m=true;var H=G._configs.specificConfig[n];var c=G._getReflectAngle(v,t);var a=function(N,L,M){var R=(L+M)/2;var Q=E.centerX;var P=E.centerY;var U=Math.cos(R);var O=Math.sin(R);var Z=Q+Math.cos(L)*N;var X=P+Math.sin(L)*N;var K=Q+Math.cos(M)*N;var J=P+Math.sin(M)*N;var W=Q+v;var V=P+t;var aa=W+Math.cos(L)*N;var Y=V+Math.sin(L)*N;var T=W+Math.cos(M)*N;var S=V+Math.sin(M)*N;return{midAngle:R,centerX:Q,centerY:P,startX:Z,startY:X,endX:K,endY:J,radius:N,darkCenterX:W,darkCenterY:V,darkStartX:aa,darkStartY:Y,darkEndX:T,darkEndY:S}};var u=function(M,L,J,N,K,Q,P,O){this.index=M;this.color=L;this.radius=J;this.percent=N;this.angleMin=K;this.angleMax=Q;this.midAngle=P;this.isHovered=false;this.data=O;this.redraw=function(R){var T=R;for(var S=0;S<4;S++){B(S,this.radius,this.angleMin,this.angleMax,R||this.color,T,T?R:this.data.darksidecolor)}};this.computeinfo=function(R){if(!this._computeinfo||R){this._computeinfo=a(this.radius,this.angleMin,this.angleMax)}return this._computeinfo};this.contact=null;this.click=function(S){var R=typeof this.data.click=="function"?this.data.click:(h.click||null);if(R){R(this.data,S)}};if(h.tip.show&&typeof h.tip.content=="function"){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display="inline"}else{var U=(this.angleMin+this.angleMax)/2;var T=(E.centerX+this.radius*0.5*Math.cos(U))*q;var S=(E.centerY+this.radius*0.5*Math.sin(U))*o;this.tip=G._createTip(h.tip.content(this.data),T,S);var R=this;
R.tip.onclick=function(V){R.click(V)}}};this.hideTip=function(){if(this.tip){this.tip.style.display="none"}}}};var F=function(J){return LChart.Methods.computeDifferAngle(J,c*Math.PI)<Math.PI/2};var i=function(P,O,N,L,K,M,Q,J){this.content=P;this.length=O;this.width=N;this.height=L;this.floatright=K;this.floattop=M;this.data=Q;this.contact=J;this.color=this.contact.color;this.index=this.contact.index;this.resetposition=function(){var S=this.contact.computeinfo(),R=F(S.midAngle);var W=1.15,U=Math.cos(S.midAngle),T=Math.sin(S.midAngle),V=T>0?T:0;this.startX=(R?(S.centerX+S.darkCenterX)/2:S.centerX)+S.radius*U;this.startY=(R?(S.centerY+S.darkCenterY)/2:S.centerY)+S.radius*T;this.left=(R?S.darkCenterX:S.centerX)+b*W*U+(this.floatright?0:-this.width);this.top=(R?S.darkCenterY:S.centerY)+b*W*T+V*this.length-this.length-d};this.endX=function(){return this.left+(this.floatright?0:this.width)};this.endY=function(){return this.top+this.height/2}};var g=function(J){return(J-j.minvalue)/(j.maxvalue-j.minvalue)};var B=function(J,Q,M,O,Z,Y,S,ab,V){var R=a(Q,M,O);S=S||LChart.Methods.getDarkenColor(Z);G.ctx.save();G.ctx.transform(q,0,0,o,0,0);switch(J){case 0:G.DrawFigures.createArc(R.darkCenterX,R.darkCenterY,R.radius,0,null,S,M,O,true);break;case 1:G.DrawFigures.createCloseFigure([[R.darkCenterX,R.darkCenterY],[R.centerX,R.centerY],[R.endX,R.endY],[R.darkEndX,R.darkEndY]],S);break;case 2:G.DrawFigures.createCloseFigure([[R.darkCenterX,R.darkCenterY],[R.centerX,R.centerY],[R.startX,R.startY],[R.darkStartX,R.darkStartY]],S);break;default:G.DrawFigures.createArc(R.centerX,R.centerY,R.radius,Y?0:C,D,Z,M,O,true);break}G.ctx.restore();var L=h.outerLabel;if(ab&&L.show&&typeof L.content=="function"){var P=L.length||b/12;var T=LChart.Methods.JudgeBetweenAngle(-Math.PI*0.5,Math.PI*0.5,R.midAngle);var aa=LChart.Methods.JudgeBetweenAngle(-Math.PI,0,R.midAngle);var X=L.content(ab);var N=G.DrawFigures.measureText(X,null,L.fontsize||(P-1),L.fontfamily);var W=N+(L.withlegend?P+3*e:2*e);var U=P+d*2;var K=new i(X,P,W,U,T?1:0,aa?1:0,ab,V);w.outerLabels.push(K);V.contact=K}};var k=function(T){var K=h.scale;var U=K.linewidth;if(!(K.linewidth>0)){return}var N=0;for(var M=j.minvalue+j.interval;M<=j.maxvalue;M+=j.interval){var Y=K.linecolors&&K.linecolors.length>0?K.linecolors[N%K.linecolors.length]:"rgb(190,190,190)";G.ctx.save();G.ctx.transform(q,0,0,o,0,0);G.DrawFigures.createArc(E.centerX,E.centerY,b*g(M),U,Y);G.ctx.restore();N++}var S=h.staff;var Q=S.content;if(!S.show||typeof Q!="function"||S.directions==null||!(S.directions.length>0)){return}var R=S.fontsize||b/j.scalecount*0.6;var V=S.backcolor;var L=0;if(V){for(var M=j.minvalue+j.interval;M<=j.maxvalue;M+=j.interval){var O=G.DrawFigures.measureText(Q(M),S.fontweight,R,S.fontfamily);L=Math.max(L,O)}}N=0;var P=function(ad,ac,ae){G.ctx.save();G.ctx.transform(q,0,0,o,0,0);var ab=(ac=="n"||ac=="s")?E.centerX:(ac=="w"?E.centerX-ae:E.centerX+ae);var Z=(ac=="w"||ac=="e")?E.centerY+R/2.5:(ac=="n"?E.centerY-ae+R/2.5:E.centerY+ae+R/2.5);if(V){G.DrawFigures.createRectangleFill(ab-L/2-1,Z-R+1,L+2,R+2,V)}var aa=G.DrawFigures.createText(ad,ab,Z,"center",S.fontweight,R,S.fontfamily,W);if(T){G.coordinates.polar[n].staff.push({direction:ac,text:ad,left:ab-aa/2,right:ab+aa/2,top:Z-R,bottom:Z,size:R,length:aa})}G.ctx.restore()};for(var M=j.minvalue+j.interval;M<=j.maxvalue;M+=j.interval){var W=S.fontcolor||"#000000";var J=b*g(M);var X=Q(LChart.Methods.FormatNumber(M));if(S.directions.__contains("n")){P(X,"n",J)}if(S.directions.__contains("s")){P(X,"s",J)}if(S.directions.__contains("e")){P(X,"e",J)}if(S.directions.__contains("w")){P(X,"w",J)}N++}};var y=function(Q,N){var K=h.outerLabel;if(!(K.show&&typeof K.content=="function")){return}var L=(l?E.coordinate.minY:5)/o;var J=(l?E.coordinate.maxY:G.canvas.height-5)/o;w.outerLabels.sort(function(T,S){return T.index-S.index});if(m){for(var M=0,P;P=w.outerLabels[M];M++){P.resetposition()}m=false}var O=function(){var Y=function(ad,ac){return Math.max(ad.left,ac.left)<=Math.min(ad.left+ad.width,ac.left+ac.width)&&Math.max(ad.top,ac.top)<=Math.min(ad.top+ad.height,ac.top+ac.height)};var U=[];var S=[];var Z=[];var T=[];for(var X=0,ab;ab=w.outerLabels[X];X++){while(L>ab.top){ab.top+=d;ab.left+=ab.floatright?e:-e}while(J<ab.top+ab.height){ab.top-=d;ab.left+=ab.floatright?e:-e}if(ab.floatright&&ab.floattop){Z.push(ab)}else{if(ab.floatright&&!ab.floattop){T.push(ab)}else{if(!ab.floatright&&ab.floattop){U.push(ab)}else{S.push(ab)}}}}var aa=0;var W=[];var V=function(ad){if(W.length>0){for(var ac=0,ae;ae=W[ac];ac++){while(Y(ae,ad)&&aa<1000){ad.top+=ad.floattop?d:-d;ad.left+=ad.floatright?e:-e;aa++}}}W.push(ad)};for(var X=U.length-1;X>=0;X--){V(U[X])}W=[];for(var X=0;X<S.length;X++){V(S[X])}W=[];for(var X=0;X<Z.length;X++){V(Z[X])}W=[];for(var X=T.length-1;X>=0;X--){V(T[X])}};var R=function(U,T){var S=U;G.ctx.save();G.ctx.transform(q,0,0,o,0,0);if(!T){G.DrawFigures.createQuadraticCurve(S.startX,S.startY,S.startX*0.8+S.endX()*0.2,S.startY*0.2+S.endY()*0.8,S.endX(),S.endY(),1,K.bordercolor);
if(K.backcolor){G.DrawFigures.createRectangleFill(S.left,S.top,S.width,S.height,K.backcolor)}var Y=K.fontsize||(S.length-1);var X=S.left+(S.floatright?e+(K.withlegend?S.length+e:0):S.width-e);var W=S.top+S.length/2+Y/2+d/2;G.DrawFigures.createText(S.content,X,W,S.floatright?"left":"right",null,Y,K.fontfamily,K.color);if(K.borderwidth&&K.borderwidth>0){G.DrawFigures.createRectangleBorder(S.left,S.top,S.width,S.height,K.borderwidth,K.bordercolor)}}if(K.withlegend){var V=K.legendtype||"s";G.DrawFigures.createPointElement(V,S.left+e,S.top+d,S.length,S.color,V!="x",T,2,V=="x")}G.ctx.restore()};if(Q){R(Q.contact,N)}else{O();G.coordinates.polar[n].outerlabels.length=0;for(var M=0,P;P=w.outerLabels[M];M++){R(P);G.coordinates.polar[n].outerlabels[M]={index:P.contact.index,left:P.left,top:P.top,width:P.width,height:P.height}}}};var x=function(R,Z){var N=I;var S=h.animation&&h.animateScale?R:1;var U=h.animation&&h.animateRotate?R:1;var T=Z>=1;if(!h.scaleOverlay){k(T)}var P=[],K=[];for(var W=0,aa;aa=z[W];W++){var J=(aa.value/r.segmentTotal)*100;var X=U*Math.PI*2*(h.averageAngle?1/f:(J/100));var V=aa.color||p[W%p.length];var L=N;var M=N+G._formatSegmentAngle(X);var Q=(L+M)/2;if(T){aa.percent=J}var Y=new u(W,V,b*S*g(aa.value),J,L,M,Q,aa);P.push(Y);N=M}K=G._get3DFaceDrawOrder(P,v,t);for(var W=0,O;O=K[W];W++){B(O.type,O.shape.radius,O.shape.angleMin,O.shape.angleMax,O.shape.color,false,O.shape.data.darksidecolor,T&&O.type==3?O.shape.data:null,T&&O.type==3?O.shape:null)}if(h.scaleOverlay){k(T)}if(T){w.cemicircles=P;w.faces=K;y()}};var s=function(){var L=function(V,T){var O=null;for(var R=0,S;S=w.cemicircles[R];R++){var Q=S.computeinfo();var P=LChart.Methods.GetCurrentAngle(V,T,Q.centerX,Q.centerY);var M=(Math.pow(V-Q.centerX,2)+Math.pow(T-Q.centerY,2)<=Math.pow(S.radius,2))&&LChart.Methods.JudgeBetweenAngle(S.angleMin,S.angleMax,P);var X=false;if(h.outerLabel&&h.outerLabel.show&&S.contact){var U=S.contact;if(V>=U.left&&V<=U.left+U.width&&T>=U.top&&T<=U.top+U.height){X=true}}if(M||X){O=S;break}}if(!O){for(var R=w.cemicircles.length-1;R>=0;R--){var S=w.cemicircles[R];var Q=S.computeinfo();var N=LChart.Methods.GetCurrentAngle(V,T,Q.darkCenterX,Q.darkCenterY);var W=(Math.pow(V-Q.darkCenterX,2)+Math.pow(T-Q.darkCenterY,2)<=Math.pow(S.radius,2))&&LChart.Methods.JudgeBetweenAngle(S.angleMin,S.angleMax,N);if(W){O=S;break}}}return O};var K=function(O){var O=window.event||O;var M=LChart.Methods.tranferLocation(G._getMouseLoction(O),q,o);var N=L(M.X,M.Y);if(N){N.click(O)}};var J=function(Q){var Q=window.event||Q;var T=LChart.Methods.tranferLocation(G._getMouseLoction(Q),q,o);var O=L(T.X,T.Y);if(O){G._configs.cursorPointer=true}if(H.currentMouseShape!=O){var R=H.currentMouseShape;if(R){var N=typeof R.data.mouseleave=="function"?R.data.mouseleave:(h.mouseleave||null);if(N){N(R.data,Q)}}if(H.currentMouseShape){G.redrawAll()}H.currentMouseShape=O;for(var P=0,R;R=w.cemicircles[P];P++){if(R.isHovered){R.isHovered=false;if(R.hideTip){R.hideTip()}}}if(O){O.isHovered=true;var M=h.mouseoverTransparency;var S="rgba(255,255,255,"+(M>0&&M<1?M:0.2)+")";O.redraw(S);y(O,S);if(O.showTip){O.showTip()}var U=typeof O.data.mouseover=="function"?O.data.mouseover:(h.mouseover||null);if(U){U(O.data,Q)}}}};G._addEventListener("click",K);G._addEventListener("mousemove",J)};var A=function(){if(!h.scaleOverlay){k()}for(var J=0,K;K=w.faces[J];J++){B(K.type,K.shape.radius,K.shape.angleMin,K.shape.angleMax,K.shape.color,null,K.shape.data.darksidecolor)}if(h.scaleOverlay){k()}y()};return{drawSegments:x,mouseEvents:s,redraw:A}};