if(!window.LChart){throw new Error("未能加载loongchart.core.js，该js必须在其他LChart框架的js加载之前被引用。\n"+"Not loaded loongchart.core.js which must be loaded before other LChart's js.")}else{LChart.Const.Skins.BlackAndWhite.RangeHistogram3D={SmallLabelColor:null,BigLabelColor:null}}LChart.RangeHistogram3D=LChart.getCore().__extends({GraphType:"RangeHistogram3D"});LChart.RangeHistogram3D._spreadSkin=function(b,a){b.smallLabel={};b.smallLabel.color=a.SmallLabelColor||null;b.bigLabel={};b.bigLabel.color=a.BigLabelColor||null};LChart.RangeHistogram3D._getDefaultOptions=function(b){var a=LChart.Methods.Extend(b,{animateY:true,animateX:true,histogram:{colors:null,length:null,gap:null,useSameColor:true},tip:{content:function(c){var d=null;if(this.valueType=="d"){d="<br/>Small Value: "+c.value[0].format("yyyy-MM-dd")+"<br/>Big Value: "+c.value[1].format("yyyy-MM-dd")}else{if(this.valueType=="t"){d="<br/>Small Value: "+c.value[0].format("MM-dd hh:mm")+"<br/>Big Value: "+c.value[1].format("MM-dd hh:mm")}else{if(this.valueType=="m"){d="<br/>Small Value: "+c.value[0].format("hh:mm:ss.S")+"<br/>Big Value: "+c.value[1].format("hh:mm:ss.S")}else{d="<br/>Small Value: "+c.value[0]+"<br/>Big Value: "+c.value[1]}}}return"<div>"+c.text+"："+d+"&nbsp;</div>"}},smallLabel:{show:true,content:function(c){if(this.valueType=="d"){return c.format("yyyy-MM-dd")}else{if(this.valueType=="t"){return c.format("MM-dd hh:mm")}else{if(this.valueType=="m"){return c.format("hh:mm:ss.S")}else{return c.toString()}}}},color:null,fontweight:null,fontsize:null,fontfamily:null},bigLabel:{show:true,content:function(c){if(this.valueType=="d"){return c.format("yyyy-MM-dd")}else{if(this.valueType=="t"){return c.format("MM-dd hh:mm")}else{if(this.valueType=="m"){return c.format("hh:mm:ss.S")}else{return c.toString()}}}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return a};LChart.RangeHistogram3D._getCheckOptions=function(){return{__top:[["animateY","b"],["animateX","b"]],histogram:[["colors","ca"],["length","n"],["gap","n"],["useSameColor","b"]],smallLabel:[["show","b"],["content","f"],["color","c"],["fontweight","s"],["fontsize","n"],["fontfamily","s"]],bigLabel:[["show","b"],["content","f"],["color","c"],["fontweight","s"],["fontsize","n"],["fontfamily","s"]]}};LChart.RangeHistogram3D._drawgraphic=function(s,h,n,d){if(d.valueType=="p"){throw new Error(s._messages.WrongParam+s._messages.ValueTypeMustNotBePercent)}s._configs.recreateAssists=true;if(h==s.ID){s._configs.valueAxiaDataIsRange=true}var f=s._formatAxisData();var a=s._calculateOutersValid();var r=s._computeAxis(a);var q=s._getDrawableCoordinate();s.shapes[h]={histograms:[]};if(!s.coordinates.histograms){s.coordinates.histograms={}}s.coordinates.histograms[h]=[];var u=s._configs.specificConfig[h];var b=d.shadow.show&&d.shadow.blur>0;var g=b?{color:d.shadow.color,blur:d.shadow.blur}:null;var e=d.histogram.length;var l=d.histogram.gap;if(f.multiple){if(l&&l>0){var t=(r.labelDistance-f.demanCount*2)/(f.demanCount+1);l=Math.min(l,t)}else{l=r.labelDistance/20}}var e=d.histogram.length;if(e&&e>0){var c=f.multiple?((r.labelDistance-(f.demanCount+1)*l)/f.demanCount):r.labelDistance*0.8;e=Math.min(e,c)}else{e=(r.labelDistance-(f.demanCount+1)*l)/(f.multiple?(f.demanCount+0.5):1.5)}var i=(d.histogram.colors&&d.histogram.colors.length>0?d.histogram.colors:null)||LChart.Const.Defaults.FillColors;if(h==s.ID){s.coordinates.draw=q;s._configs.legendColors=i}var p=function(w,J,I,G,F,C){var L=w.left-r.stagewidth*r.sinsightangle;var H=w.top+r.stagewidth*r.cossightangle;var z=J||w.color;if(F){s.DrawFigures.create3DHistogram(L,H,w.width,w.height,z,0,r.sightangle,r.stagewidth,null,I?J:w.topcolor||LChart.Methods.getDarkenColor(z,0.7),I?J:w.rightcolor||LChart.Methods.getDarkenColor(z,0.8),G)}if(C){var K=w.data.value[0];var B=w.data.value[1];if(K>B){K=w.data.value[1];B=w.data.value[0]}var x=d.smallLabel;if(x.show){var y=typeof x.content=="function"?x.content.call(d,K):"";if(y){var N=w.data.smallfontsize||x.fontsize||LChart.Methods.CapValue(height,18,11);var v=w.data.smallfontweight||x.fontweight;var M=w.data.smallfontcolor||x.color;var D=(w.left+L)/2+w.width/2;var A=H+w.height+N;s.DrawFigures.createText(y,D,A,"center",v,N,x.fontfamily,M)}}x=d.bigLabel;if(x.show){var E=typeof x.content=="function"?x.content.call(d,B):"";if(E){var N=w.data.bigfontsize||x.fontsize||LChart.Methods.CapValue(height,18,11);var v=w.data.bigfontweight||x.fontweight;var M=w.data.bigfontcolor||x.color;var D=(w.left+L)/2+w.width/2;var A=w.top-N/3;s.DrawFigures.createText(E,D,A,"center",v,N,x.fontfamily,M)}}}};var k=function(E,C,y,B,w,D,z,v,x,A){this.indexX=E;this.indexY=C;this.left=y;this.top=B;this.width=w;this.height=D;this.data=A;this.isHovered=false;this.color=z;this.topcolor=v;this.rightcolor=x;this.redraw=function(J,G,I,F){var H=g;if(b&&F){H=LChart.Methods.DeepCopy(g);H.color=F}p(this,F,J,H,G,I)};this.click=function(G){var F=typeof this.data.click=="function"?this.data.click:(d.click||null);if(F){F(this.data,G)}};if(d.tip.show&&typeof d.tip.content=="function"){this.tip=null;
this.showTip=function(){if(this.tip){this.tip.style.display="inline"}else{var H=this.left;var G=this.top+this.height/2;this.tip=s._createTip(d.tip.content.call(d,this.data),H,G);if(H+this.tip.clientWidth>r.maxX){s._changeTip(this.tip,H-this.tip.clientWidth)}var F=this;F.tip.onclick=function(I){F.click(I)}}};this.hideTip=function(){if(this.tip){this.tip.style.display="none"}}}};var m=function(y,I){var z=function(O){var N=(d.animateY?y:1)*(r.maxY-r.minY)*s._getFormatDiff(f.vValueType,f.vMinValue,O)/s._getFormatDiff(f.vValueType,f.vMinValue,f.vMaxValue);return N};var A=function(P,O,Q){var N=(Q&&d.animateY?y:1)*(r.maxY-r.minY)*s._getFormatDiff(f.vValueType,P,O)/s._getFormatDiff(f.vValueType,f.vMinValue,f.vMaxValue);return N};var B=I>=1;var K=[];for(var H=0,J;J=n[H];H++){var E=(d.animateX?y:1)*e;if(f.multiple){var F=J.color||i[H%i.length];for(var G=0;G<J.value.length;G++){var M=J.value[G];if(M[0]!=null&&M[1]!=null){var w=f.demanCount/2-H;var x=r.startPos+r.labelDistance*G-w*e-(w-0.5)*l;var D=z(M);var C=r.maxY-D;var D=A(M[0],M[1],true);var C=r.maxY-D-A(f.vMinValue,Math.min(M[0],M[1]));var L=null;if(B){L={value:M,label:f.lLabels[G],click:J.click,mouseover:J.mouseover,mouseleave:J.mouseleave,text:J.text,indexX:H,indexY:G,bigfontcolor:J.bigfontcolor,bigfontsize:J.bigfontsize,bigfontweight:J.bigfontweight,smallfontcolor:J.smallfontcolor,smallfontsize:J.smallfontsize,smallfontweight:J.smallfontweight};if(!s.coordinates.histograms[h][G]){s.coordinates.histograms[h][G]=[]}s.coordinates.histograms[h][G][H]={left:x,top:C,width:E,height:D,color:F}}var v=new k(H,G,x,C,E,D,F,J.topcolor,J.rightcolor,L);K.push(v)}}}else{var M=J.value;if(M[0]!=null&&M[1]!=null){var x=r.startPos+r.labelDistance*H-e/2;var D=A(M[0],M[1],true);var C=r.maxY-D-A(f.vMinValue,Math.min(M[0],M[1]));var F=J.color||(d.histogram.useSameColor?"rgba(69,114,167,1)":i[H%i.length]);if(B){J.indexX=H;J.indexY=null;s.coordinates.histograms[h][H]={left:x,top:C,width:E,height:D,color:F}}var v=new k(H,1,x,C,E,D,F,J.topcolor,J.rightcolor,B?J:null);K.push(v)}}}if(f.multiple){K.sort(function(O,N){if(O.indexX==N.indexX){return O.indexY-N.indexY}else{return O.indexX-N.indexX}})}for(var H=0,v;v=K[H];H++){p(v,v.color,false,g,true)}if(B){for(var H=0,v;v=K[H];H++){p(v,v.color,false,g,false,true)}s.shapes[h].histograms=K}};var j=function(){var x=function(H,G){var A=null;var C=r.cossightangle*r.stagewidth;var z=r.sinsightangle*r.stagewidth;for(var B=0,D;D=s.shapes[h].histograms[B];B++){var J=D.left-r.stagewidth*r.sinsightangle;var I=D.top+r.stagewidth*r.cossightangle;if(J<=H&&J+D.width>=H&&I<=G&&I+D.height>=G){A=D;break}}if(!A){for(var B=0,D;D=s.shapes[h].histograms[B];B++){if(D.top<=G&&D.top+C>=G){var F=D.left-z*(G-D.top)/C;if(F<=H&&F+D.width>=H){A=D;break}}}}if(!A){for(var B=0,D;D=s.shapes[h].histograms[B];B++){if(D.left+D.width-z<=H&&D.left+D.width>=H){var E=D.top+C*(D.left+D.width-H)/z;if(E<=G&&E+D.height>=G){A=D;break}}}}return A};var w=function(A){var A=window.event||A;var y=s._getMouseLoction(A);var z=x(y.X,y.Y);if(z){z.click(A)}};var v=function(F){var F=window.event||F;var A=s._getMouseLoction(F);var E=x(A.X,A.Y);if(E){s._configs.cursorPointer=true}if(u.currentMouseShape!=E){var B=u.currentMouseShape;if(B){var y=typeof B.data.mouseleave=="function"?B.data.mouseleave:(d.mouseleave||null);if(y){y(B.data,F)}}if(b||u.currentMouseShape){s.redrawAll()}u.currentMouseShape=E;for(var D=0,B;B=s.shapes[h].histograms[D];D++){if(B!=E&&B.isHovered){B.isHovered=false;if(B.hideTip){B.hideTip()}}}if(E){E.isHovered=true;var C=d.mouseoverTransparency;E.redraw(true,true,false,"rgba(255,255,255,"+(C>0&&C<1?C:0.2)+")");if(E.showTip){E.showTip()}var z=typeof E.data.mouseover=="function"?E.data.mouseover:(d.mouseover||null);if(z){z(E.data,F)}}}};s._addEventListener("click",w);s._addEventListener("mousemove",v)};var o=function(){for(var w=0,v;v=s.shapes[h].histograms[w];w++){v.redraw(false,true)}for(var w=0,v;v=s.shapes[h].histograms[w];w++){v.redraw(false,false,true)}};return{drawSegments:m,mouseEvents:j,redraw:o}};