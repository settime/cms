if(!window.LChart){throw new Error("未能加载loongchart.core.js，该js必须在其他LChart框架的js加载之前被引用。\n"+"Not loaded loongchart.core.js which must be loaded before other LChart's js.")}else{LChart.Const.Skins.BlackAndWhite.Bar={TopLabelColor:null}}LChart.Bar=LChart.getCore().__extends({GraphType:"Bar"});LChart.Bar._spreadSkin=function(b,a){b.topLabel={};b.topLabel.color=a.TopLabelColor||null};LChart.Bar._getDefaultOptions=function(b){var a=LChart.Methods.Extend(b,{animateY:true,animateX:true,bar:{colors:null,length:null,gap:null,useSameColor:true},topLabel:{show:true,content:function(c){if(this.valueType=="d"||this.valueType=="t"||this.valueType=="m"){return""}else{if(this.valueType=="p"){return c.percent.toFixed(1).toString()+"%"}else{return c.value.toString()}}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return a};LChart.Bar._getCheckOptions=function(){return{__top:[["animateY","b"],["animateX","b"]],bar:[["colors","ca"],["length","n"],["gap","n"],["useSameColor","b"]],topLabel:[["show","b"],["content","f"],["color","c"],["fontweight","s"],["fontsize","n"],["fontfamily","s"]]}};LChart.Bar._drawgraphic=function(w,k,p,e){if(k==w.ID){w._configs.invertAxis=true;w._configs.notAllowValueNegative=true}var g=w._formatAxisData();var b=w._calculateOutersValid();var u=w._computeAxis(b);var t=w._getDrawableCoordinate();w.shapes[k]={bars:[]};if(!w.coordinates.bars){w.coordinates.bars={}}w.coordinates.bars[k]=[];var z=w._configs.specificConfig[k];var a=g.vValueType=="p";var c=e.shadow.show&&e.shadow.blur>0;var h=c?e.shadow:null;if(h){if(h.blur&&h.offsetX<h.blur){h.offsetX=h.blur}}var f=e.bar.length;var n=e.bar.gap;if(g.multiple){if(n&&n>0){var y=(u.labelDistance-g.demanCount*2)/(g.demanCount+1);n=Math.min(n,y)}else{n=u.labelDistance/20}}else{n=0}if(f&&f>0){var d=g.multiple?((u.labelDistance-(g.demanCount+1)*n)/g.demanCount):u.labelDistance*0.8;f=Math.min(f,d)}else{f=(u.labelDistance-(g.demanCount+1)*n)/(g.multiple?(g.demanCount+0.5):1.5)}var m=function(B,A){if(A!=undefined){var C=g.demanCount/2-B;return u.startPos-u.labelDistance*A-C*f-(C-0.5)*n}else{return u.startPos-u.labelDistance*B-f/2}};var j=(e.bar.colors&&e.bar.colors.length>0?e.bar.colors:null)||LChart.Const.Defaults.FillColors;if(k==w.ID){w.coordinates.draw=t;w._configs.legendColors=j;if(g.multiple){w._configs.pointsPosition={labelDistance:u.labelDistance,startPoints:[]};for(var s=0,v;v=p[s];s++){w._configs.pointsPosition[s]=m(s,0)+f/2}}}var r=function(B,G,i,H,D,E,C){w.DrawFigures.createRectangleFill(B,G,i,H,D,C||h);if(E&&e.topLabel.show){var A=e.topLabel;var F=typeof A.content=="function"?A.content.call(e,E):"";if(F){var K=A.fontsize||LChart.Methods.CapValue(H,18,11);var J=B+i+K/2;var I=G+H/2+K/3;w.DrawFigures.createText(F,J,I,"left",E.fontweight||A.fontweight,E.fontsize||K,A.fontfamily,E.fontcolor||A.color)}}};var x=function(C,B,G,F,D,i,A,E){this.indexX=C;this.indexY=B;this.left=G;this.top=F;this.width=D;this.height=i;this.data=E;this.isHovered=false;this.color=A;this.redraw=function(H,I){if(arguments.length==1&&typeof arguments[0]=="boolean"){I=arguments[0];H=undefined}var J=h;if(h&&h.show&&H){J=LChart.Methods.DeepCopy(h);J.color=H}r(this.left,this.top,this.width,this.height,H||this.color,I?this.data:null,J)};this.click=function(I){var H=typeof this.data.click=="function"?this.data.click:(e.click||null);if(H){H(this.data,I)}};if(e.tip.show&&typeof e.tip.content=="function"){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display="inline"}else{var J=this.left+this.width/2+5;var I=this.top+this.height/2;this.tip=w._createTip(e.tip.content.call(e,this.data),J,I);var H=this;H.tip.onclick=function(K){H.click(K)}}};this.hideTip=function(){if(this.tip){this.tip.style.display="none"}}}};var o=function(A,F){var J=function(O){var i=(e.animateX?A:1)*(u.maxX-u.minX)*w._getFormatDiff(g.vValueType,g.vMinValue,O)/w._getFormatDiff(g.vValueType,g.vMinValue,g.vMaxValue);return i};for(var H=0,N;N=p[H];H++){var M=(e.animateY?A:1)*f;if(g.multiple){var E=N.color||j[H%j.length];var L=a?N.percent:N.value;for(var D=0;D<L.length;D++){if(N.value[D]!=null){var K=m(H,D);var B=J(L[D]);var C=u.minX;if(F>=1){var G={click:N.click,mouseover:N.mouseover,mouseleave:N.mouseleave,text:N.text,label:g.lLabels[D],indexX:D,indexY:H,fontsize:N.fontsize,fontcolor:N.fontcolor,fontweight:N.fontweight};if(a){G.percent=L[D];G.value=N.value[D]}else{G.value=L[D]}var I=new x(D,H,C,K,B,M,E,G);w.shapes[k].bars.push(I);r(C,K,B,M,E,G);if(!w.coordinates.bars[k][D]){w.coordinates.bars[k][D]=[]}w.coordinates.bars[k][D][H]={left:C,top:K,width:B,height:M,color:E}}else{r(C,K,B,M,E)}}}}else{if(N.value!=null){var K=m(H);var B=J(a?N.percent:N.value);var C=u.minX;var E=N.color||(e.bar.useSameColor?"rgba(69,114,167,1)":j[H%j.length]);if(F>=1){N.indexX=H;N.indexY=null;var I=new x(H,null,C,K,B,M,E,N);w.shapes[k].bars.push(I);r(C,K,B,M,E,N);w.coordinates.bars[k][H]={left:C,top:K,width:B,height:M,color:E}}else{r(C,K,B,M,E)}}}}};var l=function(){var B=function(C,G){var F=null;for(var E=0,D;D=w.shapes[k].bars[E];
E++){if(D.left<=C&&D.left+D.width>=C&&D.top<=G&&D.top+D.height>=G){F=D;break}}return F};var A=function(E){var E=window.event||E;var C=w._getMouseLoction(E);var D=B(C.X,C.Y);if(D){D.click(E)}};var i=function(J){var J=window.event||J;var E=w._getMouseLoction(J);var I=B(E.X,E.Y);if(I){w._configs.cursorPointer=true}if(z.currentMouseShape!=I){var F=z.currentMouseShape;if(F){var C=typeof F.data.mouseleave=="function"?F.data.mouseleave:(e.mouseleave||null);if(C){C(F.data,J)}}if(c||z.currentMouseShape){w.redrawAll()}z.currentMouseShape=I;for(var H=0,F;F=w.shapes[k].bars[H];H++){if(F!=I&&F.isHovered){F.isHovered=false;if(F.hideTip){F.hideTip()}}}if(I){I.isHovered=true;var G=e.mouseoverTransparency;I.redraw("rgba(255,255,255,"+(G>0&&G<1?G:0.2)+")");if(I.showTip){I.showTip()}var D=typeof I.data.mouseover=="function"?I.data.mouseover:(e.mouseover||null);if(D){D(I.data,J)}}}};w._addEventListener("click",A);w._addEventListener("mousemove",i)};var q=function(){for(var B=0,A;A=w.shapes[k].bars[B];B++){A.redraw(true)}};return{drawSegments:o,mouseEvents:l,redraw:q}};