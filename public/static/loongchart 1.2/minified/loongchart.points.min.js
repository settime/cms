if(!window.LChart){throw new Error("未能加载loongchart.core.js，该js必须在其他LChart框架的js加载之前被引用。\n"+"Not loaded loongchart.core.js which must be loaded before other LChart's js.")}else{LChart.Const.Skins.BlackAndWhite.Points={NodeLineColor:"#ffffff",AlignlineLineColor:null}}LChart.Points=LChart.getCore().__extends({GraphType:"Points"});LChart.Points._spreadSkin=function(b,a){b.node={};b.alignline={};b.node.linecolor=a.NodeLineColor||null;b.alignline.linecolor=a.AlignlineLineColor||null};LChart.Points._getDefaultOptions=function(b){var a=LChart.Methods.Extend(b,{invertAxis:false,labelAxis:{valueType:null,content:function(c){if(this.valueType=="d"){return c.format("yyyy-MM-dd")}else{if(this.valueType=="t"){return c.format("MM-dd hh:mm")}else{if(this.valueType=="m"){return c.format("hh:mm:ss.S")}else{return c.toString()}}}},minvalue:null,maxvalue:null,interval:null,sort:true},node:{colors:null,nodetype:null,linecolor:null,linewidth:null,length:null,fillcolor:null},tip:{merge:false,spotdistance:10,content:function(e,g){if(g){var d="<div>";for(var c=0;c<e.length;c++){var f=this.valueType=="p"?e[c].vpercent.toFixed(2)+"%":e[c].vvalue.toString();d+=(c>0?"<br/>":"")+e[c].text+" : "+f}d+="&nbsp;</div>";return d}else{var f=this.valueType=="p"?e.vpercent.toFixed(2)+"%":e.vvalue.toString();if(this.valueType=="d"){f=e.vvalue.format("yyyy-MM-dd")}else{if(this.valueType=="t"){f=e.vvalue.format("MM-dd hh:mm")}else{if(this.valueType=="m"){f=e.vvalue.format("hh:mm:ss.S")}}}return"<div>&nbsp;"+(e.text?e.text+"：":"")+f+"&nbsp;</div>"}}},alignline:{verticalline:true,horizontalline:true,linecolor:null},scale:{drawvertical:true}});return a};LChart.Points._getCheckOptions=function(){return{__top:[["invertAxis","b"]],labelAxis:[["valueType","s"],["content","f"],["interval","n"],["sort","b"]],node:[["colors","ca"],["nodetype","s"],["linecolor","c"],["linewidth","n"],["length","n"],["fillcolor","c"]],tip:[["merge","b"],["spotdistance","n"]],alignline:[["verticalline","b"],["horizontalline","b"],["linecolor","c"]],scale:[["drawvertical","b"]]}};LChart.Points._drawgraphic=function(x,j,s,e){x._configs.recreateAssists=true;var r=e.invertAxis;var w=j==x.ID;if(w){x._configs.invertAxis=r;if(e.labelAxis.valueType=="p"){throw new Error(x._messages.WrongParam+x._messages.LabelAxisValueTypeCannotBePercent)}}var f=x._formatAxisData();var c=x._calculateOutersValid();var v=x._computeAxis(c);var u=x._getDrawableCoordinate();if(!x.coordinates.nodes){x.coordinates.nodes={}}x.coordinates.nodes[j]={nodes:[]};x.shapes[j]={nodes:[]};var d=e.labelAxis.valueType;var b=f.vValueType=="p";var o=LChart.Methods.IsNumber(e.tip.spotdistance)&&e.tip.spotdistance>0?e.tip.spotdistance:10;var n=e.alignline.linecolor||LChart.Const.Defaults.AlignLineColor;var g=(e.node.colors&&e.node.colors.length>0?e.node.colors:null)||LChart.Const.Defaults.FillColors;if(w){x.coordinates.draw=u;x._configs.legendColors=g}var y=x._configs.specificConfig[j];var h=x._configs.pointsPosition;y.mergeTips=[];var q=(r?v.maxX-v.minX:v.maxY-v.minY);var i=(r?v.maxY-v.minY:v.maxX-v.minX);var a=e.node.length||LChart.Methods.CapValue(i/100,10,6);var m=function(A,E,D,B,C,z){this.index=A;this.centerX=E;this.centerY=D;this.color=z;this.isHovered=false;this.nodelength=B;this.data=C;this.click=function(G){var F=typeof this.data.click=="function"?this.data.click:(e.click||null);if(F){F(this.data,G)}};if(e.tip.show&&typeof e.tip.content=="function"){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display="inline"}else{var H=this.centerX+a+5;var G=this.centerY-a-10;this.tip=x._createTip(e.tip.content.call(e,this.data,false),H,G);if(this.centerX+this.tip.clientWidth>v.maxX){x._changeTip(this.tip,H-5-a-this.tip.clientWidth)}var F=this;F.tip.onclick=function(I){F.click(I)}}};this.hideTip=function(){if(this.tip){this.tip.style.display="none"}}}};var l=function(G,F,C,E){var B=e.node;var D=E.nodelength||a;var A=E.nodetype||B.nodetype||"c";var z=E.nodelinecolor||B.linecolor||C;var H=E.nodelinewidth||B.linewidth;x.DrawFigures.createPointElement(A,G,F,D,C,true,z,H,true,true)};var p=function(B,G){var J=function(R){var Q=(e.animation?B:1)*q*x._getFormatDiff(f.vValueType,f.vMinValue,R)/x._getFormatDiff(f.vValueType,f.vMinValue,f.vMaxValue);return Q};var D=function(Q){if(d){return i*x._getFormatDiff(f.lValueType,f.lMinValue,Q)/x._getFormatDiff(f.lValueType,f.lMinValue,f.lMaxValue)}else{if(f.multiple){return Q==0?0:i*Q/(f.tuftCount-1)}else{if(w){return Q==0?0:i*Q/(s.length-1)}else{return v.labelDistance*Q}}}};var K=function(T,V,Z,Y,R,Q,ac,ab,aa,U,X){if(G>=1){var S={vvalue:ac,lvalue:ab,text:aa,click:X.click,mouseover:X.mouseover,mouseleave:X.mouseleave,nodetype:X.nodetype,nodelength:X.nodelength,nodelinecolor:X.nodelinecolor,nodelinewidth:X.nodelinewidth,nodefillcolor:X.nodefillcolor};if(U!=null){S.vpercent=U}var W=new m(V,Z,Y,R,S,Q);x.shapes[j].nodes.push(W);if(T>=0){x.coordinates.nodes[j][T][V]={centerX:Z,centerY:Y,length:R}}else{x.coordinates.nodes[j][V]={centerX:Z,centerY:Y,length:R}}}};var O,P,I,C,A;if(f.multiple){for(var H=0,L;
L=s[H];H++){var N=L.text||"";var F=L.color||g[H%g.length];var z=L.nodetype;if(G>=1){x.coordinates.nodes[j][H]=[]}for(var E=0;E<L.value.length;E++){M=L.value[E];O=d?M[0]:E;P=d?M[1]:M;I=b?L.percent[E]:null;vdrawvalue=b?I:P;if(vdrawvalue!=null&&O!=null){A=r?v.minX+J(vdrawvalue):v.maxY-J(vdrawvalue);if(h){C=h[H]+(r?-h.labelDistance*E:h.labelDistance*E)}else{C=(r?v.maxY-D(O):v.minX+D(O))}l(r?A:C,r?C:A,F,L);K(H,E,r?A:C,r?C:A,L.nodelength||a,F,P,O,N,I,L)}}}}else{for(var H=0;H<s.length;H++){var M=s[H];var N=M.text||"";var F=M.color||(e.node.colors&&e.node.colors.length>0?g[H%g.length]:null)||e.node.fillcolor||"#000000";O=d?M.value[0]:H;P=d?M.value[1]:M.value;I=b?s[H].percent:null;vdrawvalue=b?I:P;if(vdrawvalue!=null&&O!=null){C=w?(r?v.maxY-D(O):v.minX+D(O)):v.startPos+(r?-D(O):D(O));A=r?v.minX+J(vdrawvalue):v.maxY-J(vdrawvalue);l(r?A:C,r?C:A,F,M);K(-1,H,r?A:C,r?C:A,M.nodelength||a,F,P,O,N,I,M)}}}};var k=function(){var C=function(D,H){var G=null;for(var F=x.shapes[j].nodes.length-1;F>=0;F--){var E=x.shapes[j].nodes[F];if(Math.sqrt(Math.pow(D-E.centerX,2)+Math.pow(H-E.centerY,2))<=E.nodelength/2){G=E;break}}return G};var B=function(P,N){var G=[];var J=0;if(N<=v.maxY&&N>=v.minY&&P>=v.minX&&P<=v.maxX){var K=-1;var D=(r?v.maxY:v.minX);var Q=(r?N:P);if(f.tuftCount==1){if(Math.abs(D-Q)<o){K=0;J=D}}else{var O=i/(f.tuftCount-1);for(var H=1;H<f.tuftCount;H++){var F=D+(r?-H*O:(H-1)*O);var E=D+(r?-(H-1)*O:H*O);if(F<=Q&&E>=Q){var M=Math.abs(F-Q);var I=Math.abs(E-Q);if(M<o&&M<=I){K=r?H:H-1;J=F}else{if(I<o&&I<=M){K=r?H-1:H;J=E}}break}}}for(var H=0,L;L=x.shapes[j].nodes[H];H++){if(L.index==K){G.push(L)}}}return{shapes:G,loc:J}};var A=function(F){var F=window.event||F;var D=x._getMouseLoction(F);var E=C(D.X,D.Y);if(E){E.click(F)}};var z=function(M){var M=window.event||M;var P=x._getMouseLoction(M);var F=h||f.lValueType||!f.multiple;var G=C(P.X,P.Y);if(G){x._configs.cursorPointer=true}if(y.currentMouseShape!=G){var N=y.currentMouseShape;if(N){var D=typeof N.data.mouseleave=="function"?N.data.mouseleave:(e.mouseleave||null);if(D){D(N.data,M)}}y.currentMouseShape=G;for(var L=0,N;N=x.shapes[j].nodes[L];L++){if(N!=G&&N.isHovered){N.isHovered=false;if(F&&N.hideTip){N.hideTip()}}}if(G){G.isHovered=true;if(e.alignline.verticalline||e.alignline.horizontalline){x.redrawAll()}if(e.alignline.verticalline){x.DrawFigures.createLine(G.centerX,v.minY,G.centerX,v.maxY+1,1,n)}if(e.alignline.horizontalline){x.DrawFigures.createLine(v.minX,G.centerY,v.maxX,G.centerY,1,n)}if(G.showTip&&F){G.showTip()}var Q=typeof G.data.mouseover=="function"?G.data.mouseover:(e.mouseover||null);if(Q){Q(G.data,M)}}else{if(F&&(e.alignline.verticalline||e.alignline.horizontalline)){x.redrawAll()}}}if(!F){var I=B(P.X,P.Y);if(x.loc!=I.loc){x.loc=I.loc;if(e.tip.merge){for(var L=0;L<y.mergeTips.length;L++){if(y.mergeTips[L]){y.mergeTips[L].style.display="none"}}}else{for(var L=0,N;N=x.shapes[j].nodes[L];L++){if(N.hideTip){N.hideTip()}}}if(r&&e.alignline.horizontalline||!r&&e.alignline.verticalline){x.redrawAll()}if(I.shapes.length){if(!r&&e.alignline.verticalline){x.DrawFigures.createLine(I.loc,v.minY,I.loc,v.maxY+1,1,n)}if(r&&e.alignline.horizontalline){x.DrawFigures.createLine(v.minX,I.loc,v.maxX,I.loc,1,n)}if(e.tip.merge){if(I.shapes[0].showTip){var O=y.mergeTips[I.shapes[0].index];if(!O){var K=[];var E=0;var R=0;for(var L=0,N;N=I.shapes[L];L++){K.push(N.data);R+=N.centerY;E+=N.centerX}var J=E/I.shapes.length+5;var H=R/I.shapes.length;O=x._createTip(e.tip.content.call(e,K,true),J,H);x._changeTip(O,null,H-O.clientHeight/2+10);if(J+O.clientWidth>v.maxX){x._changeTip(O,J-5-a-O.clientWidth)}y.mergeTips[I.shapes[0].index]=O}O.style.display="inline"}}else{for(var L=0,N;N=I.shapes[L];L++){if(N.showTip){N.showTip()}}}}}}};x._addEventListener("click",A);x._addEventListener("mousemove",z)};var t=function(){var C,B=null;for(var A=0;A<x.shapes[j].nodes.length;A++){var z=x.shapes[j].nodes[A];l(z.centerX,z.centerY,z.color,z.data)}};return{drawSegments:p,mouseEvents:k,redraw:t}};