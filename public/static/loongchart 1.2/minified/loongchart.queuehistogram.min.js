if(!window.LChart){throw new Error("未能加载loongchart.core.js，该js必须在其他LChart框架的js加载之前被引用。\n"+"Not loaded loongchart.core.js which must be loaded before other LChart's js.")}else{LChart.Const.Skins.BlackAndWhite.QueueHistogram={LabelColor:null}}LChart.QueueHistogram=LChart.getCore().__extends({GraphType:"QueueHistogram"});LChart.QueueHistogram._spreadSkin=function(b,a){b.label={};b.label.color=a.LabelColor||null};LChart.QueueHistogram._getDefaultOptions=function(b){var a=LChart.Methods.Extend(b,{animateY:true,animateX:true,splitpoint:null,contrastmode:true,histogram:{colors:null,length:null,gap:null,useSameColor:true},label:{show:true,content:function(c){if(this.valueType=="d"){return c.value.format("MM-dd")}else{if(this.valueType=="t"){return c.value.format("hh:mm")}else{if(this.valueType=="m"){return c.value.format("mm:ss.S")}else{return c.value.toString()}}}},color:null,fontweight:null,fontsize:null,fontfamily:null}});return a};LChart.QueueHistogram._getCheckOptions=function(){return{__top:[["animateY","b"],["animateX","b"],["contrastmode","b"]],histogram:[["colors","ca"],["length","n"],["gap","n"],["useSameColor","b"]],label:[["show","b"],["content","f"],["color","c"],["fontweight","s"],["fontsize","n"],["fontfamily","s"]]}};LChart.QueueHistogram._drawgraphic=function(A,k,q,f){if(f.valueType=="p"){throw new Error(A._messages.WrongParam+A._messages.ValueTypeMustNotBePercent)}var b=f.splitpoint;var u=b==null;if(k==A.ID){A._configs.computeSplitPoint=u}var j=A._formatAxisData();if(u){b=j.splitpoint}else{j.splitpoint=b}if(j.demanCount>1&&(b>=j.vMaxval||b<=j.vMinval)){throw new Error(A._messages.WrongSet+A._messages.WrongSplitPoint)}var c=A._calculateOutersValid();var w=A._computeAxis(c);var l=(f.histogram.colors&&f.histogram.colors.length>0?f.histogram.colors:null)||LChart.Const.Defaults.FillColors;var v=A._getDrawableCoordinate();if(!A.coordinates.histograms){A.coordinates.histograms={}}A.coordinates.histograms[k]=[];A.shapes[k]={histograms:[]};var D=A._configs.specificConfig[k];var a=f.contrastmode;var p=a?Math.ceil(j.demanCount/2-0.1):j.demanCount;var n=f.histogram.gap;var g=f.histogram.length;var z=p>1;if(z){if(n&&n>0){var C=(w.labelDistance-p*2)/(p+1);n=Math.min(n,C)}else{n=w.labelDistance/20}}else{n=0}if(g&&g>0){var e=z?((w.labelDistance-(p+1)*n)/p):w.labelDistance*0.8;g=Math.min(g,e)}else{g=(w.labelDistance-(p+1)*n)/(z?(p+0.5):1.5)}var d=f.shadow.show;var h=function(i){var E=null;if(d){var F=Math.max(Math.abs(f.shadow.blur),Math.abs(f.shadow.offsetY));E=LChart.Methods.DeepCopy(f.shadow);E.offsetY=i?F:-F}return E};var y=function(F,E){if(E!=undefined){var G=p/2-(a?parseInt(F/2):F);return w.startPos+w.labelDistance*E-G*g-(G-0.5)*n}else{return w.startPos+w.labelDistance*F-g/2}};if(k==A.ID){A.coordinates.draw=v;A._configs.legendColors=l;if(j.multiple){A._configs.pointsPosition={labelDistance:w.labelDistance,startPoints:[]};for(var t=0,x;x=q[t];t++){A._configs.pointsPosition[t]=y(t,0)+g/2}}}var s=function(G,F,N,i,O,J,L,I){A.DrawFigures.createRectangleFill(F,N,i,O,J,I||h(G));if(L&&f.label.show){var E=f.label;var M=typeof E.content=="function"?E.content.call(f,L):"";if(M){var K=F+i/2;var P=E.fontsize||LChart.Methods.CapValue(i/2,18,11);var H=G?N+O+P:N-P/3;A.DrawFigures.createText(M,K,H,"center",L.fontweight||E.fontweight,L.fontsize||P,E.fontfamily,L.fontcolor||E.color)}}};var B=function(F,L,J,E,I,i,K,G,H){this.isSmall=F;this.indexX=L;this.indexY=J;this.left=E;this.top=I;this.width=i;this.height=K;this.data=H;this.isHovered=false;this.color=G;this.redraw=function(M,N){if(arguments.length==1&&typeof arguments[0]=="boolean"){N=arguments[0];M=undefined}var O=h(this.isSmall);if(O&&M){O.color=M}s(this.isSmall,this.left,this.top,this.width,this.height,M||this.color,N?this.data:null,O)};this.click=function(N){var M=typeof this.data.click=="function"?this.data.click:(f.click||null);if(M){M(this.data,N)}};if(f.tip.show&&typeof f.tip.content=="function"){this.tip=null;this.showTip=function(){if(this.tip){this.tip.style.display="inline"}else{var O=this.left+this.width/2+5;var N=this.top+this.height/2;this.tip=A._createTip(f.tip.content.call(f,this.data),O,N);if(O+this.tip.clientWidth>w.maxX){A._changeTip(this.tip,O-this.width/2-this.tip.clientWidth)}var M=this;M.tip.onclick=function(P){M.click(P)}}};this.hideTip=function(){if(this.tip){this.tip.style.display="none"}}}};var o=function(E,L){var O=function(U){var T=Math.abs(A._getFormatDiff(j.vValueType,b,U));var i=(f.animateY?E:1)*(w.maxY-w.minY)*T/A._getFormatDiff(j.vValueType,j.vMinValue,j.vMaxValue);return i};for(var N=0,S;S=q[N];N++){var F=(f.animateX?E:1)*g;if(j.multiple){var J=S.color||l[N%l.length];for(var K=0;K<S.value.length;K++){var G=S.value[K];if(G!=null){var I=G<b;var H=y(N,K);var R=O(G);var Q=I?w.splitLinePos:w.splitLinePos-R;if(L>=1){var M={text:S.text,label:j.lLabels[K],value:G,indexX:K,indexY:N,fontsize:S.fontsize,fontcolor:S.fontcolor,fontweight:S.fontweight,click:S.click,mouseover:S.mouseover,mouseleave:S.mouseleave};var P=new B(I,K,N,H,Q,F,R,J,M);A.shapes[k].histograms.push(P);
s(I,H,Q,F,R,J,M);if(!A.coordinates.histograms[k][K]){A.coordinates.histograms[k][K]=[]}A.coordinates.histograms[k][K][N]={left:H,top:Q,width:F,height:R,color:J}}else{s(I,H,Q,F,R,J)}}}}else{var G=S.value;if(G!=null){var I=G<b;var H=y(N);var R=O(G);var Q=I?w.splitLinePos:w.splitLinePos-R;var J=S.color||(f.histogram.useSameColor?"rgba(69,114,167,1)":l[N%l.length]);if(L>=1){var M={text:S.text,value:G,indexX:N,indexY:null,fontsize:S.fontsize,fontcolor:S.fontcolor,fontweight:S.fontweight,click:S.click,mouseover:S.mouseover,mouseleave:S.mouseleave};var P=new B(I,N,null,H,Q,F,R,J,M);A.shapes[k].histograms.push(P);s(I,H,Q,F,R,J,M);A.coordinates.histograms[k][N]={left:H,top:Q,width:F,height:R,color:J}}else{s(I,H,Q,F,R,J)}}}}};var m=function(){var F=function(G,K){var J=null;for(var I=0,H;H=A.shapes[k].histograms[I];I++){if(H.left<=G&&H.left+H.width>=G&&H.top<=K&&H.top+H.height>=K){J=H;break}}return J};var E=function(I){var I=window.event||I;var G=A._getMouseLoction(I);var H=F(G.X,G.Y);if(H){H.click(I)}};var i=function(N){var N=window.event||N;var I=A._getMouseLoction(N);var M=F(I.X,I.Y);if(M){A._configs.cursorPointer=true}if(D.currentMouseShape!=M){var J=D.currentMouseShape;if(J){var G=typeof J.data.mouseleave=="function"?J.data.mouseleave:(f.mouseleave||null);if(G){G(J.data,N)}}if(d||D.currentMouseShape){A.redrawAll()}D.currentMouseShape=M;for(var L=0,J;J=A.shapes[k].histograms[L];L++){if(J!=M&&J.isHovered){J.isHovered=false;if(J.hideTip){J.hideTip()}}}if(M){M.isHovered=true;var K=f.mouseoverTransparency;M.redraw("rgba(255,255,255,"+(K>0&&K<1?K:0.2)+")");if(M.showTip){M.showTip()}var H=typeof M.data.mouseover=="function"?M.data.mouseover:(f.mouseover||null);if(H){H(M.data,N)}}}};A._addEventListener("click",E);A._addEventListener("mousemove",i)};var r=function(){for(var F=0,E;E=A.shapes[k].histograms[F];F++){E.redraw(true)}};return{drawSegments:o,mouseEvents:m,redraw:r}};