Date.prototype.format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in c){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(c[b]):(("00"+c[b]).substr((""+c[b]).length)))}}return a};lcharttools.clock=function(a){var b=this;b.parentDivID=a;b._initial=function(){var d=document.getElementById(b.parentDivID);if(d!=null&&d.nodeName.toLowerCase()=="div"){b.parentDiv=d}else{throw new Error("The parent element doesn't exist or isn't a div!")}b.parentDiv.innerHTML="";var c=document.createElement("canvas");b.ID="LChart_"+Math.random().toString().substring(5);c.setAttribute("id",b.ID);c.width=b.parentDiv.clientWidth;c.height=b.parentDiv.clientHeight;if(!!window.ActiveXObject&&!document.createElement("canvas").getContext){if(window.G_vmlCanvasManager){c=window.G_vmlCanvasManager.initElement(c)}else{throw new Error("please include excanvas.js!")}}b.parentDiv.appendChild(c);b.canvas=c;b.ctx=c.getContext("2d");b._configs={};b._configs._adjust=0;b._configs._runningHandler=null;b._configs._currentVal=null;b._configs._staticTime=null;b._configs._computed=null;b.options=b._getDefaultOptions()};b._getDefaultOptions=function(){var c={centerX:null,centerY:null,radius:null,tickType:"fluent",adjust:0,canvas:{backcolor:null,borderwidth:1,bordercolor:null},background:{backcolor:null,borderwidth:1,bordercolor:null,shadowcolor:"#000000",shadowblur:0},calibration:{backcolor:null,margin:null,interval:4,thinwidth:2,thickwidth:4,thinlength:null,thicklength:null,thinlinecolor:"#999999",thicklinecolor:"#000000"},labels:{margin:null,labels:["1","2","3","4","5","6","7","8","9","10","11","12"],labelcontrol:"111111111111",rotate:false,fontcolor:null,fontsize:null,fontfamily:null,fontweight:"bold"},pointer:{nodecolor:null,nodelength:null,hourpincolor:null,hourheadwidth:null,hourtailwidth:null,hourpinlength:null,minutepincolor:null,minuteheadwidth:null,minutetailwidth:null,minutepinlength:null,secondpincolor:"#a01313",secondheadwidth:null,secondtailwidth:null,secondpinlength:null},currentValue:{show:true,content:function(d){return d.format("hh:mm:ss")},xdistance:null,ydistance:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,backcolor:null,borderwidth:0,bordercolor:null}};return c};b._computeOptions=function(q){if(!q&&b._configs._computed){return b._configs._computed}var e=b.options;var m=e.centerX||b.canvas.width/2;var k=e.centerY||b.canvas.height/2;var h=e.radius||Math.min(b.canvas.width,b.canvas.height)*0.4;var u=e.calibration.margin||h/12;var E=e.calibration.thinlength||h/15;var D=e.calibration.thicklength||E*1.2;var x=h-u;var p=h-u-E;var g=h-u-D;var G={margin:u,thinlength:E,thicklength:D,outerRadius:x,thinInnerRadius:p,thickInnerRadius:g};var v=e.labels.margin||h/15;var C=e.labels.fontsize||h/5;var i=g-v;var A={margin:v,radius:i,fontsize:C};var c=e.pointer.nodelength||h/12;var z=e.pointer.hourtailwidth||h/14;var t=e.pointer.hourheadwidth||h/40;var B=e.pointer.hourpinlength||h*0.5;var F=e.pointer.minutetailwidth||h/25;var y=e.pointer.minuteheadwidth||h/40;var d=e.pointer.minutepinlength||h*0.8;var l=e.pointer.secondtailwidth||h/40;var f=e.pointer.secondheadwidth||0;var o=e.pointer.secondpinlength||h;if(B>=h+c||d>=h+c||o>=h+c){throw new Error("pinlength should be less than radius!")}var w={nodelength:c,hour:{tailwidth:z,headwidth:t,pinlength:B,pincolor:e.pointer.hourpincolor},minute:{tailwidth:F,headwidth:y,pinlength:d,pincolor:e.pointer.minutepincolor},second:{tailwidth:l,headwidth:f,pinlength:o,pincolor:e.pointer.secondpincolor}};var s=e.currentValue.xdistance||0;var r=e.currentValue.ydistance==null?0.4:e.currentValue.ydistance;var j=e.currentValue.fontsize||h/8;var n={xdistance:s,ydistance:r,fontsize:j};b._configs._computed={centerX:m,centerY:k,radius:h,calibration:G,labels:A,pointer:w,currentValue:n};return b._configs._computed};b._drawCanvasBackround=function(){var c=b.options.canvas;if(c.backcolor){lcharttools.createRect(b.ctx,0,0,b.canvas.width,b.canvas.height,c.backcolor)}else{b.ctx.clearRect(0,0,b.canvas.width,b.canvas.height)}var d=c.borderwidth||0;if(d>0){lcharttools.createRect(b.ctx,0,0,b.canvas.width,b.canvas.height,null,d*2,c.bordercolor)}};b._drawBackground=function(){var d=b._computeOptions();var c=b.options.background;var e=null;if(c.shadowblur>0){e={color:c.shadowcolor||"#000000",blur:c.shadowblur}}lcharttools.createArc(b.ctx,d.centerX,d.centerY,d.radius,0,null,c.backcolor||"#F2F2F2",null,null,e);lcharttools.createArc(b.ctx,d.centerX,d.centerY,d.radius,c.borderwidth,c.bordercolor)};b._drawCalibration=function(){var f=b._computeOptions();var o=f.calibration;var C=f.labels;var d=b.options.calibration;var q=b.options.labels;if(d.backcolor){lcharttools.createRing(b.ctx,f.centerX,f.centerY,o.thinInnerRadius,o.outerRadius,d.backcolor,0,Math.PI*2)
}var z=Math.PI*2/12;var h=d.interval>0?z/(d.interval+1):null;var n=[0,0.2,0.3,0.3,0.3,0.2,0,-0.25,-0.4,-0.3,-0.25,-0.25];var v=[0.5,0.4,0.4,0.3,0.2,0.1,0.1,0.15,0.2,0.3,0.4,0.45];for(var r=0;r<12;r++){var u=z*r;var c=Math.sin(u);var e=Math.cos(u);var A=f.centerX+o.thickInnerRadius*c;var x=f.centerY-o.thickInnerRadius*e;var y=f.centerX+o.outerRadius*c;var w=f.centerY-o.outerRadius*e;lcharttools.createLine(b.ctx,A,x,y,w,d.thickwidth,d.thicklinecolor);if(q.labelcontrol[(r+11)%12]=="1"){var k=q.labels[(r+11)%q.labels.length];if(q.rotate){var m=f.centerX+(C.radius-C.fontsize/2)*c;var l=f.centerY-(C.radius-C.fontsize/2)*e;lcharttools.createText(b.ctx,k,m,l,"center",q.fontweight,C.fontsize,q.fontfamily,q.fontcolor,u)}else{var g=lcharttools.measureText(b.ctx,k,q.fontweight,C.fontsize,q.fontfamily);var t=-g*n[r];var s=v[r]*1.3*C.fontsize;var m=f.centerX+C.radius*c+t;var l=f.centerY-C.radius*e+s;lcharttools.createText(b.ctx,k,m,l,"center",q.fontweight,C.fontsize,q.fontfamily,q.fontcolor)}}if(d.interval>0){for(var p=1;p<=d.interval;p++){var B=u+h*p;c=Math.sin(B);e=Math.cos(B);A=f.centerX+o.thinInnerRadius*c;x=f.centerY-o.thinInnerRadius*e;y=f.centerX+o.outerRadius*c;w=f.centerY-o.outerRadius*e;lcharttools.createLine(b.ctx,A,x,y,w,d.thinwidth,d.thinlinecolor)}}}};b._drawPointer=function(){var h=b._computeOptions();var f=b.options.pointer;var c=b._configs._currentVal;var j=c.getTime();var i=Date.parse(c.format("yyyy/MM/dd "+(c.getHours()>11?"12":"00")+":00:00"));var d=Math.PI*2*(j-i)/43200000;var g=Math.PI*2*(j-Date.parse(c.format("yyyy/MM/dd "+c.getHours()+":00:00")))/3600000;var e=Math.PI*2*(j-Date.parse(c.format("yyyy/MM/dd "+c.getHours()+":"+c.getMinutes()+":00")))/60000;var k=function(q,s){var x=Math.sin(q);var B=Math.cos(q);var n=h.centerX+s.pinlength*0.8*x;var l=h.centerY-s.pinlength*0.8*B;var o=n-s.headwidth/2*B;var m=l-s.headwidth/2*x;var r=n+s.headwidth/2*B;var p=l+s.headwidth/2*x;var u=h.centerX-s.pinlength*0.2*x;var t=h.centerY+s.pinlength*0.2*B;var z=u-s.tailwidth/2*B;var y=t-s.tailwidth/2*x;var w=u+s.tailwidth/2*B;var v=t+s.tailwidth/2*x;var A=[[o,m],[r,p],[w,v],[z,y]];lcharttools.createCloseFigure(b.ctx,A,s.pincolor||"#000000")};k(d,h.pointer.hour);k(g,h.pointer.minute);k(e,h.pointer.second);lcharttools.createArc(b.ctx,h.centerX,h.centerY,h.pointer.nodelength/2,0,null,f.nodecolor||f.secondpincolor||"#000000")};b._drawCurrentValue=function(){var c=b.options.currentValue;if(!b._configs._currentVal||!c.show||typeof c.content!="function"){return}var e=b._configs._currentVal;var g=b._computeOptions();var j=c.content(e);var i=g.centerX-g.radius*g.currentValue.xdistance;var h=g.centerY-g.radius*g.currentValue.ydistance+g.currentValue.fontsize/3;if(c.backcolor||c.borderwidth){var d=lcharttools.measureText(b.ctx,j,c.fontweight,g.currentValue.fontsize,c.fontfamily);var f=i-d/2-g.currentValue.fontsize/4;var k=h-g.currentValue.fontsize;lcharttools.createRect(b.ctx,f,k,d+g.currentValue.fontsize/2,g.currentValue.fontsize*4/3,c.backcolor,c.borderwidth,c.bordercolor)}lcharttools.createText(b.ctx,j,i,h,"center",c.fontweight,g.currentValue.fontsize,c.fontfamily,c.fontcolor)};b._drawValue=function(){b._drawCanvasBackround();b._drawBackground();b._drawCalibration();b._drawPointer();b._drawCurrentValue()};b.setOptions=function(c){b.options=lcharttools.funcs._override(b.options,c)};b.setAdjust=function(c){b._configs._adjust=c||0};b.setTime=function(c){if(!c||!c.getTime){c=null}b._configs._staticTime=c};b.draw=function(){b._computeOptions(true);if(b._configs._runningHandler){clearInterval(b._configs._runningHandler)}b._configs._adjust=b.options.adjust||0;if(b._configs._staticTime){b._configs._currentVal=new Date(b._configs._staticTime.getTime()+b._configs._adjust);b._drawValue();return}if(b.options.tickType=="fluent"){b._configs._runningHandler=setInterval(function(){b._configs._currentVal=new Date((new Date).getTime()+b._configs._adjust);b._drawValue()},10)}else{if(b.options.tickType=="vibrate"){b._configs._runningHandler=setInterval(function(){var c=(new Date).getTime()+b._configs._adjust;b._configs._currentVal=new Date(c);if(c-Date.parse(b._configs._currentVal.format("yyyy/MM/dd hh:mm:ss"))<=30){b._drawValue()}},10)}}};b._initial();return b};