lcharttools.dashboard=function(a){var b=this;b.parentDivID=a;b._initial=function(){var d=document.getElementById(b.parentDivID);if(d!=null&&d.nodeName.toLowerCase()=="div"){b.parentDiv=d}else{throw new Error("The parent element doesn't exist or isn't a div!")}b.parentDiv.innerHTML="";var c=document.createElement("canvas");b.ID="LChart_"+Math.random().toString().substring(5);c.setAttribute("id",b.ID);c.width=b.parentDiv.clientWidth;c.height=b.parentDiv.clientHeight;if(!!window.ActiveXObject&&!document.createElement("canvas").getContext){if(window.G_vmlCanvasManager){c=window.G_vmlCanvasManager.initElement(c)}else{throw new Error("please include excanvas.js!")}}b.parentDiv.appendChild(c);b.canvas=c;b.ctx=c.getContext("2d");b._configs={};b._configs._currentval=0;b._configs._nextval=0;b._configs._unfinished=[];b._configs._isRunning=false;b._configs._isWarning=false;b._configs._warningCount=0;b._configs._warningHandler=null;b._configs._computed=null;b.options=b._getDefaultOptions()};b._getDefaultOptions=function(){var c={animation:true,animationTime:1,animationSteps:24,centerX:null,centerY:null,radius:null,canvas:{backcolor:null,borderwidth:1,bordercolor:null},background:{backcolor:null,borderwidth:1,bordercolor:null,shadowcolor:"#000000",shadowblur:0},calibration:{margin:null,minvalue:0,maxvalue:200,scalecount:10,startangle:-0.8,endangle:0.8,length:null,linecolor:"#999999",thinwidth:1,thickwidth:2,thickerwidth:4,grades:[{color:"rgba(16,173,28,0.5)",minvalue:0,maxvalue:100},{color:"rgba(255,153,51,0.5)",minvalue:100,maxvalue:150},{color:"rgba(239,11,11,0.5)",minvalue:150,maxvalue:null}]},labels:{margin:null,content:function(d){return d.toString()},interval:10,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null},pointer:{nodecolor:null,nodelength:null,pincolor:null,tailwidth:null,pinlength:null},unit:{content:null,distance:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,backcolor:null,borderwidth:0,bordercolor:null},currentValue:{show:true,content:function(d){return d.toFixed(1)},distance:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null,backcolor:null,borderwidth:0,bordercolor:null},warning:{thresholdmin:null,thresholdmax:null,warningframes:5,contentmin:"Exceeded the minimum warning value!!!",contentmax:"Exceeded the maximum warning value!!!",locatetop:true,distance:null,fontcolor:null,fontsize:null,fontfamily:null,fontweight:null}};return c};b._computeOptions=function(o){if(!o&&b._configs._computed){return b._configs._computed}var d=b.options;var m=d.centerX||b.canvas.width/2;var l=d.centerY||b.canvas.height/2;var h=d.radius||Math.min(b.canvas.width,b.canvas.height)*0.4;var r=d.calibration.margin||h/20;var g=d.calibration.length||h/10;var k=h-r-g;var u=h-r;var C={length:g,margin:r,innerRadius:k,outerRadius:u};var s=d.labels.margin||h/15;var B=d.labels.fontsize||h/10;var i=k-s;var y={margin:s,radius:i,fontsize:B};var c=d.pointer.nodelength||h/12;var x=d.pointer.tailwidth||h/25;var A=d.pointer.pinlength||h*0.9;if(A>=h+c){throw new Error("pinlength should be less than radius!")}var t={nodelength:c,tailwidth:x,pinlength:A};var e=d.unit.distance==null?0.2:d.unit.distance;var w=d.unit.fontsize||h/8;var q={distance:e,fontsize:w};var p=d.currentValue.distance==null?0.2:d.currentValue.distance;var j=d.currentValue.fontsize||h/8;var n={distance:p,fontsize:j};var f=d.warning.distance==null?1.1:d.warning.distance;var z=d.warning.fontsize||h/8;var v={distance:f,fontsize:z};b._configs._computed={centerX:m,centerY:l,radius:h,calibration:C,labels:y,pointer:t,unit:q,currentValue:n,warning:v};return b._configs._computed};b._drawCanvasBackround=function(){var c=b.options.canvas;if(c.backcolor){lcharttools.createRect(b.ctx,0,0,b.canvas.width,b.canvas.height,c.backcolor)}else{b.ctx.clearRect(0,0,b.canvas.width,b.canvas.height)}var d=c.borderwidth||0;if(d>0){lcharttools.createRect(b.ctx,0,0,b.canvas.width,b.canvas.height,null,d*2,c.bordercolor)}};b._drawBackground=function(){var d=b._computeOptions();var c=b.options.background;var e=null;if(c.shadowblur>0){e={color:c.shadowcolor||"#000000",blur:c.shadowblur}}lcharttools.createArc(b.ctx,d.centerX,d.centerY,d.radius,0,null,c.backcolor||"#F2F2F2",null,null,e);lcharttools.createArc(b.ctx,d.centerX,d.centerY,d.radius,c.borderwidth,c.bordercolor)};b._drawCalibration=function(){var h=b._computeOptions();var f=b.options.calibration;var y=b.options.labels;var u=h.calibration.margin;var m=h.calibration.length;var q=h.calibration.innerRadius;var w=h.calibration.outerRadius;var k=h.labels.radius;var v=f.grades;for(var z=0;z<v.length;z++){var t=v[z].minvalue||f.minvalue;var e=v[z].maxvalue||f.maxvalue;var j=f.startangle-0.5+(f.endangle-f.startangle)*(t-f.minvalue)/(f.maxvalue-f.minvalue);var l=f.startangle-0.5+(f.endangle-f.startangle)*(e-f.minvalue)/(f.maxvalue-f.minvalue);lcharttools.createRing(b.ctx,h.centerX,h.centerY,q,w,v[z].color,j*Math.PI,l*Math.PI)}var p=f.scalecount*10;var n=(f.endangle-f.startangle)*Math.PI/p;var o=(f.maxvalue-f.minvalue)/p;for(var z=0;
z<p+1;z++){var A=f.startangle*Math.PI+n*z;var d=Math.sin(A);var g=Math.cos(A);var E=h.centerX+q*d;var D=h.centerY-q*g;var C=h.centerX+w*d;var B=h.centerY-w*g;lcharttools.createLine(b.ctx,E,D,C,B,z%10==0?f.thickerwidth:(z%5==0?f.thickwidth:f.thinwidth),f.linecolor);if(z%y.interval==0){var c=f.minvalue+z*o;var x=y.content(c);var s=h.centerX+(k-h.labels.fontsize/2)*d;var r=h.centerY-(k-h.labels.fontsize/2)*g;lcharttools.createText(b.ctx,x,s,r,"center",y.fontweight,h.labels.fontsize,y.fontfamily,y.fontcolor,A)}}};b._drawPointer=function(g){var i=b._computeOptions();var e=b.options.pointer;var f=b.options.calibration;var h=f.startangle*Math.PI+(f.endangle-f.startangle)*Math.PI*(g-f.minvalue)/(f.maxvalue-f.minvalue);var l=Math.sin(h);var p=Math.cos(h);var d=i.centerX+(i.pointer.pinlength-i.pointer.nodelength)*l;var c=i.centerY-(i.pointer.pinlength-i.pointer.nodelength)*p;var n=i.centerX-i.pointer.nodelength*l-i.pointer.tailwidth/2*p;var m=i.centerY+i.pointer.nodelength*p-i.pointer.tailwidth/2*l;var k=i.centerX-i.pointer.nodelength*l+i.pointer.tailwidth/2*p;var j=i.centerY+i.pointer.nodelength*p+i.pointer.tailwidth/2*l;var o=[[d,c],[n,m],[k,j]];lcharttools.createArc(b.ctx,i.centerX,i.centerY,i.pointer.nodelength/2,0,null,e.nodecolor||"#000000");lcharttools.createCloseFigure(b.ctx,o,e.pincolor||"#000000")};b._drawUnit=function(){var d=b.options.unit;if(!d.content){return}var e=b._computeOptions();var f=e.centerY-e.radius*e.unit.distance+e.unit.fontsize/3;if(d.backcolor||d.borderwidth){var c=lcharttools.measureText(b.ctx,d.content,d.fontweight,e.unit.fontsize,d.fontfamily);var h=e.centerX-c/2-e.unit.fontsize/4;var g=f-e.unit.fontsize;lcharttools.createRect(b.ctx,h,g,c+e.unit.fontsize/2,e.unit.fontsize*4/3,d.backcolor,d.borderwidth,d.bordercolor)}lcharttools.createText(b.ctx,d.content,e.centerX,f,"center",d.fontweight,e.unit.fontsize,d.fontfamily,d.fontcolor)};b._drawCurrentValue=function(){var d=b.options.currentValue;if(!b._configs._nextval||!d.show||typeof d.content!="function"){return}var f=b._computeOptions();var g=f.centerY+f.radius*f.currentValue.distance+f.currentValue.fontsize/3;var e=d.content(b._configs._nextval);if(d.backcolor||d.borderwidth){var c=lcharttools.measureText(b.ctx,e,d.fontweight,f.currentValue.fontsize,d.fontfamily);var i=f.centerX-c/2-f.currentValue.fontsize/4;var h=g-f.currentValue.fontsize;lcharttools.createRect(b.ctx,i,h,c+f.currentValue.fontsize/2,f.currentValue.fontsize*4/3,d.backcolor,d.borderwidth,d.bordercolor)}lcharttools.createText(b.ctx,e,f.centerX,g,"center",d.fontweight,f.currentValue.fontsize,d.fontfamily,d.fontcolor)};b._drawWarning=function(){var g=b._computeOptions();var f=b.options.warning;var d=b.options.animationSteps;var h=f.warningframes;var e=f.thresholdmin!=null&&b._configs._currentval<=f.thresholdmin;var c=f.thresholdmax!=null&&b._configs._currentval>=f.thresholdmax;if(e||c){if(b._configs._isWarning){b.disarmWarning()}b._configs._isWarning=true;b._configs._warningHandler=setInterval(function(){if(!b._configs._isRunning){if(b._configs._warningCount<h){b._drawCanvasBackround()}else{b._drawValue(b._configs._currentval);var i=g.centerY+(f.locatetop?-g.radius*g.warning.distance:g.radius*g.warning.distance)+g.warning.fontsize/3;lcharttools.createText(b.ctx,e?f.contentmin:f.contentmax,g.centerX,i,"center",f.fontweight,g.warning.fontsize,f.fontfamily,f.fontcolor||"#ff0000")}b._configs._warningCount++;if(b._configs._warningCount>h*2){b._configs._warningCount=0}}},1000/d)}else{b.disarmWarning()}};b._drawValue=function(c){b._drawCanvasBackround();b._drawBackground();b._drawCalibration();b._drawUnit();b._drawCurrentValue();b._drawPointer(c)};b.disarmWarning=function(){if(b._configs._warningHandler!=null){b._configs._isWarning=false;clearInterval(b._configs._warningHandler);b._drawValue(b._configs._currentval)}};b.setOptions=function(c){b.options=lcharttools.funcs._override(b.options,c)};b.draw=function(g){b._computeOptions(true);if(b.options.animation){var f=(b.options.animationTime||1)*1000;var c=b.options.animationSteps||24;if(f>1000){throw new Error("animationTime should not be bigger than 1!")}if(c>50){throw new Error("animationSteps should not be bigger than 50!")}b._configs._unfinished.push(g);var d=function(h){b._configs._currentval=h;b._drawWarning();if(b._configs._unfinished.length>1){b._configs._unfinished=b._configs._unfinished.slice(1);e()}else{b._drawValue(b._configs._currentval);b._configs._unfinished.length=0;b._configs._isRunning=false}};var e=function(){var k=b._configs._unfinished[0];b._configs._nextval=k;var i=b._configs._currentval;var h=(k-i)/c;if(Math.abs(h)<0.000001){d(k)}else{b._configs._isRunning=true;var l=k>=i;var j=setInterval(function(){i+=h;if(Math.abs(i-k)<0.0001||l&&i<=k||!l&&i>=k){b._drawValue(i)}else{clearInterval(j);d(k)}},f/c)}};if(!b._configs._isRunning){e()}}else{b._configs._currentval=g;b._configs._nextval=g;b._drawValue(g)}};b._initial();return b};